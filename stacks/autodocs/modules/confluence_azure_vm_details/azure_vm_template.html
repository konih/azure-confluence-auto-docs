<style>
    body {
        font-family: Arial, sans-serif;
        margin: 20px;
    }

    h1, h2, h3, p {
        margin: 0;
        padding: 0.5em 0;
    }

    h1 {
        font-size: 1.8em;
        color: #1a73e8;
        margin-bottom: 0.5em;
    }

    h2 {
        font-size: 1.4em;
        color: #1a73e8;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }

    h3 {
        font-size: 1.2em;
        color: #1a73e8;
        margin-top: 1em;
        margin-bottom: 0.5em;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin: 1em 0;
    }

    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }

    th {
        background-color: #f2f2f2;
        text-align: left;
    }

    td {
        vertical-align: top;
    }

    p {
        margin: 0.5em 0;
    }
</style>
<h1>🌐 ${vm.name} Azure VM Details</h1>
<p></p>
<p><strong>Last Generated Date:</strong> ${last_generated_date}</p>


<h2 id="overview">📋 Overview</h2>
<p></p>
%{ if include_table_of_contents }
<h2>Table of Contents</h2>
<p></p>
<ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#os-info">OS Information</a></li>
    <li><a href="#network-info">Network Information</a></li>
    <li><a href="#tags">Tags</a></li>
</ul>
<p></p>
%{ endif }

<table>
    <tr>
        <th>Parameter</th>
        <th>Value</th>
    </tr>
    <tr>
        <td>💻 VM Name</td>
        <td>${vm.name}</td>
    </tr
    <tr>
        <td>💻 Hostname</td>
        <td>vm.hostname</td>
    </tr>
    <tr>
        <td>📁 Resource Group</td>
        <td>${vm.resource_group_name}</td>
    </tr>
    <tr>
        <td>🌍 Location</td>
        <td>${vm.location}</td>
    </tr>
    <tr>
        <td>⚙️ VM Size</td>
        <td>${vm.vm_size}</td>
    </tr>
    <tr>
        <td>🕒 Provisioning State</td>
        <td>${vm.provisioning_state}</td>
    </tr>
    <tr>
        <td>🏷️ Service Class</td>
        <td>${service_class_emoji}${service_class}</td>
    </tr>
</table>

<h2 id="os-info">🖥️ OS Information</h2>
<p></p>
<table>
    <tr>
        <th>Parameter</th>
        <th>Value</th>
    </tr>
    <tr>
        <td>💾 OS Disk Name</td>
        <td>${vm.os_disk.name}</td>
    </tr>
    <tr>
        <td>🏭 OS Image Publisher</td>
        <td>${vm.os_image.publisher}</td>
    </tr>
    <tr>
        <td>📦 OS Image Offer</td>
        <td>${vm.os_image.offer}</td>
    </tr>
    <tr>
        <td>🔖 OS Image SKU</td>
        <td>${vm.os_image.sku}</td>
    </tr>
    <tr>
        <td>🔢 OS Image Version</td>
        <td>${vm.os_image.version}</td>
    </tr>
    %{ if vm.os_image.exact_version != "" }
    <tr>
        <td>🎯 OS Image Exact Version</td>
        <td>${vm.os_image.exact_version}</td>
    </tr>
    %{ endif }
</table>

<h2 id="network-info">🔗 Network Information</h2>
<p></p>
${network_interfaces_html}

<h2>🏷️ Tags</h2>
<p></p>

<table>
    <tr>
        <th>Tag</th>
        <th>Value</th>
    </tr>
    %{ for tag, value in vm.tags }
    <tr>
        <td>${tag}</td>
        <td>${value}</td>
    </tr>
    %{ endfor }
</table>

<p>Generated by Terraform using the <strong>Confluence</strong> provider.</p>